<!DOCTYPE html>
<meta charset="utf-8">
<style>
 
body {
  margin: 0;
  background: #222;
  min-width: 960px;
}
 
rect {
  fill: none;
  pointer-events: all;
}
 
circle {
  fill: none;
  stroke-width: 2.5px;
}
 
</style>
<head>
    
</head>
<body>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="./getAudio.js"></script>
<script>

var width = Math.max(960, innerWidth),
  height = Math.max(500, innerHeight);

var i = 0;
var d = 0

var svg = d3.select("body").append("svg")
  .attr("width", width)
  .attr("height", height);

svg.append("rect")
  .attr("width", width)
  .attr("height", height)
  // .on("ontouchstart" in document ? "touchmove" : "mousemove", particle);
  setInterval(() => {
    particle()
    particle()
    particle()
    if (Math.random() < .005){
      lightningFlash()
    }

  },10)

//  var top = 0
//  var left = 0
//  var right = 960
//  var bottom = 500
var yDirection = i * 2

setInterval(() => {
  for (var i = 0; i < 20; i++){
    svg.insert('circle')
      .attr('cx', i * width / 20 + (Math.random() * 10))
      .attr('cy', Math.random() * 15)
      .attr('r', 10)
      .style('stroke', d3.hsl(220, .3, .2))
      .style("stroke-width",190)
      .style("stroke-opacity", .8)
      .transition()
        .duration(600)
        .ease(Math.sqrt)
        //.attr("x", x )
        //.style("stroke", d3.hsl(Math.floor(Math.random() * 90), 1, .5))
        .style("stroke-opacity", .9)
        .remove();
  }
}, 600)


 
const lightningFlash = () => {
  const randomNumber = Math.floor(Math.random() * 960)
  svg.insert('circle')
    .attr('cx', randomNumber)
    .attr('cy', 0)
    .attr('r', 1e-6)
    .style('stroke', d3.hsl(180, 1, 1))
    .style("stroke-width",190)
    .style("stroke-opacity", .2)
    .transition()
      .duration(1000)
      .ease(Math.sqrt)
      .attr("r", 10)
      //.style("stroke", d3.hsl(Math.floor(Math.random() * 90), 1, .5))
      .style("stroke-opacity", 1e-6)
      .remove();
}
 
function particle() {
  const randomNumber = Math.floor(Math.random() * width)
  svg.insert('rect')
    .attr('x', randomNumber)
    .attr('y', 80)
    .attr('width', Math.floor(Math.random() * 2))
    .attr('height', 20)
    .style("stroke", d3.hsl(Math.floor(Math.random() * 30 + 180), 1, .5))
    .style("stroke-width", 2)
    .style("stroke-opacity", 1)
    .transition()
      .duration(1000)
      .ease(Math.sqrt)
      .attr("r", 1)
      .attr("y", height + 50)
      .attr("height", 40)
      .style("stroke", d3.hsl(Math.floor(Math.random() * 90), 1, .5))
      .style("stroke-opacity", 1e-6)
      .remove();



// d3.event.preventDefault();
}
 
</script>
</body>